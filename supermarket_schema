CREATE SCHEMA `supermarket` ;

CREATE TABLE `supermarket`.`CUSTOMER` (
  `PHONE_NUMBER` VARCHAR(10) NOT NULL,
  `FIRST_NAME` VARCHAR(45) NOT NULL,
  `LAST_NAME` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`PHONE_NUMBER`));


CREATE TABLE `supermarket`.`INVENTORY` (
  `ID` VARCHAR(20) NOT NULL,
  `NAME` VARCHAR(45) NOT NULL,
  `QTY` INT NOT NULL,
  `PRICE` DECIMAL(10) NOT NULL,
  PRIMARY KEY (`ID`));


CREATE TABLE `supermarket`.`ORDER` (
  `ORDER_ID` INT NOT NULL,
  `CUST_ID` VARCHAR(10) NOT NULL,
  `TOTAL_AMOUNT` DECIMAL(10) NOT NULL,
  PRIMARY KEY (`ORDER_ID`),
  INDEX `CUST_ID_idx` (`CUST_ID` ASC) VISIBLE,
  CONSTRAINT `CUST_ID`
    FOREIGN KEY (`CUST_ID`)
    REFERENCES `supermarket`.`CUSTOMER` (`PHONE_NUMBER`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);

ALTER TABLE `supermarket`.`ORDER` 
CHANGE COLUMN `ORDER_ID` `ORDER_ID` VARCHAR(45) NOT NULL ;


CREATE TABLE `supermarket`.`CART` (
  `ID` VARCHAR(45) NOT NULL,
  `ITEM_ID` VARCHAR(45) NOT NULL,
  `NAME` VARCHAR(45) NOT NULL,
  `PRICE` DECIMAL(10) NOT NULL,
  `QTY` INT NOT NULL,
  `ORDER_ID` VARCHAR(45) NOT NULL,
  PRIMARY KEY (`ID`),
  INDEX `ITEM_ID_idx` (`ITEM_ID` ASC) VISIBLE,
  INDEX `ORDER_ID_idx` (`ORDER_ID` ASC) VISIBLE,
  CONSTRAINT `ITEM_ID`
    FOREIGN KEY (`ITEM_ID`)
    REFERENCES `supermarket`.`INVENTORY` (`ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION,
  CONSTRAINT `ORDER_ID`
    FOREIGN KEY (`ORDER_ID`)
    REFERENCES `supermarket`.`ORDER` (`ORDER_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


CREATE TABLE `supermarket`.`AUDIT` (
  `ID` INT NOT NULL,
  `ORDER_ID` VARCHAR(45) NULL,
  `CREATED_BY` DATETIME NULL,
  `CREATED_DATE_TIME` DATETIME NULL,
  `UPDATED_BY` DATETIME NULL,
  `UPDATED_DATE_TIME` DATETIME NULL,
  PRIMARY KEY (`ID`),
  INDEX `ORDER_ID_idx` (`ORDER_ID` ASC) VISIBLE,
  CONSTRAINT `ORDER_ID_FK_AUDIT`
    FOREIGN KEY (`ORDER_ID`)
    REFERENCES `supermarket`.`ORDER` (`ORDER_ID`)
    ON DELETE NO ACTION
    ON UPDATE NO ACTION);


ALTER TABLE `supermarket`.`AUDIT` 
CHANGE COLUMN `ID` `ID` VARCHAR(45) NOT NULL ,
CHANGE COLUMN `CREATED_BY` `CREATED_BY` VARCHAR(45) NULL DEFAULT NULL ,
CHANGE COLUMN `UPDATED_BY` `UPDATED_BY` VARCHAR(45) NULL DEFAULT NULL ;



ALTER TABLE `supermarket`.`CART` 
CHANGE COLUMN `PRICE` `PRICE` DECIMAL(10,2) NOT NULL ;


ALTER TABLE `supermarket`.`INVENTORY` 
CHANGE COLUMN `ID` `ID` VARCHAR(45) NOT NULL ,
CHANGE COLUMN `PRICE` `PRICE` DECIMAL(10,2) NOT NULL ;


ALTER TABLE `supermarket`.`ORDER` 
DROP FOREIGN KEY `CUST_ID`;
ALTER TABLE `supermarket`.`ORDER` 
CHANGE COLUMN `CUST_ID` `CUST_ID` VARCHAR(45) NOT NULL ,
CHANGE COLUMN `TOTAL_AMOUNT` `TOTAL_AMOUNT` DECIMAL(10,2) NOT NULL ;
ALTER TABLE `supermarket`.`ORDER` 
ADD CONSTRAINT `CUST_ID`
  FOREIGN KEY (`CUST_ID`)
  REFERENCES `supermarket`.`customer` (`phone_number`);





